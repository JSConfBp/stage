{"version":3,"sources":["webpack:///./src/components/SpeakerInfo/index.js","webpack:///./src/components/JSVisual/index.js","webpack:///./src/pages/index.js"],"names":["SpeakerInfo","_ref","stage","speaker","react_default","a","createElement","className","name","topic","JSVisual","presentation","drawTimer","useRef","clusters","currentCluster","showPolygon","_ref2","_asyncToGenerator","regenerator_default","mark","_callee","polygon","timeout","wrap","_context","prev","next","abrupt","Promise","resolve","baseVal","setTimeout","stop","_x","_x2","apply","this","arguments","hidePolygon","_ref3","_callee2","_context2","replace","_x3","_x4","show","_ref4","_callee3","prevCluster","nextCluster","i","prevPolygon","nextPolygon","_context3","console","log","current","length","all","useEffect","Array","from","document","querySelectorAll","reduce","arr","triangle","indexMatch","match","push","clearTimeout","forEach","data-name","xmlns","xlink","width","height","viewBox","id","d","points","emptyStage","IndexPage","props","_useState","useState","Object","assign","setStage","socket","io","on","data","close","classnames","color","event","src_components_JSVisual","src_components_SpeakerInfo"],"mappings":"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","file":"component---src-pages-index-js-4048c239cd5f0a132c55.js","sourcesContent":["import React from 'react'\nimport './index.scss'\n\nconst SpeakerInfo = ({ stage }) =>\n  stage.speaker && (\n    <div className=\"speaker-info\">\n      <span className=\"name\">{stage.speaker.name}</span>\n      <span className=\"topic\">{stage.speaker.topic}</span>\n    </div>\n  )\n\nexport default SpeakerInfo\n","import React, { useEffect, useRef } from 'react'\nimport classnames from 'classnames'\nimport './index.scss'\n\nconst JSVisual = ({ presentation }) => {\n\n\tconst drawTimer = useRef(0);\n\tconst clusters = useRef([]);\n\n\tconst clusterLength = 4\n\tlet currentCluster = 0\n\n\tlet nextClusterTimeout = 3000\n\n\tconst readClusters = () => {\n\t  return Array.from(\n\t\tdocument.querySelectorAll('polygon[class^=cluster-]')\n\t  ).reduce((arr, triangle) => {\n\t\tconst indexMatch = triangle.className.baseVal.match(/^cluster-(\\d)/)\n\t\tif (indexMatch) {\n\t\t  if (!arr[indexMatch[1] - 1]) {\n\t\t\tarr.push([])\n\t\t  }\n\t\t  arr[indexMatch[1] - 1].push(triangle)\n\t\t}\n\t\treturn arr\n\t  }, [])\n\t}\n\n\tconst showPolygon = async (polygon, timeout) => {\n\t  return new Promise(resolve => {\n\t\tpolygon.className.baseVal += ' show'\n\t\tsetTimeout(resolve, timeout)\n\t  })\n\t}\n\n\tconst hidePolygon = async (polygon, timeout) => {\n\t  return new Promise(resolve => {\n\t\tpolygon.className.baseVal = polygon.className.baseVal.replace(' show', '')\n\t\tsetTimeout(resolve, timeout)\n\t  })\n\t}\n\n\tconst show = async () => {\n\n\t\tconsole.log(clusters.current);\n\n\n\t  const prevCluster =\n\t\tcurrentCluster !== 0\n\t\t  ? clusters.current[currentCluster - 1]\n\t\t  : clusters.current[clusters.current.length - 1]\n\n\t  const nextCluster = clusters.current[currentCluster]\n\n\t  //const prevLength = prevCluster.length\n\t  //const nextLength = nextCluster.length\n\n\t  console.log(currentCluster)\n\n\t  for (let i = 0; i < clusterLength; i++) {\n\t\tconst prevPolygon = prevCluster[i]\n\t\tconst nextPolygon = nextCluster[i]\n\t\tawait Promise.all([\n\t\t  hidePolygon(prevPolygon, 200),\n\t\t  showPolygon(nextPolygon, 200),\n\t\t])\n\t  }\n\n\t  currentCluster += 1\n\n\t  if (!clusters.current[currentCluster]) {\n\t\tcurrentCluster = 0\n\t  }\n\t  drawTimer.current = setTimeout(show, nextClusterTimeout)\n\t}\n\n\n\tuseEffect(() => {\n\t\tconsole.log('useEffect init')\n\t\tclusters.current = readClusters()\n\t\tconsole.log({clusters});\n\n\t\tshow()\n\n\t\treturn () => {\n\t\t  console.log('useEffect cleanup')\n\n\t\t  clusters.current = []\n\t\t  currentCluster = 0\n\t\t  clearTimeout(drawTimer.current)\n\n\t\t  Array.from(document.querySelectorAll('polygon.fill')).forEach(polygon => {\n\t\t\tpolygon.className.baseVal = polygon.className.baseVal.replace(\n\t\t\t  'show',\n\t\t\t  ''\n\t\t\t)\n\t\t  })\n\t\t}\n\t  }, [presentation])\n\n\treturn (<svg\n        data-name=\"Layer 3\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xlink=\"http://www.w3.org/1999/xlink\"\n        width=\"3280\"\n        height=\"1080\"\n        viewBox=\"0 0 3280 1080\"\n      >\n        <defs>\n          <clipPath id=\"mask\" className=\"mask\">\n            <path d=\"M1596.53,386l-43.77,43.77h89L1597.94,386l42.56-42.56,43.27,43.26,44.47-44.47H1554.18l-44-44V387.2L1554,343.44Zm129.29-42.76-42,42.06-42.06-42.06Zm-170.64,85.53,42-42.06,42.06,42.06Zm84.11-85.53-42,42.06-42.06-42.06Zm-128.08,41.56V300.67l41.55,41.56h0l.5.5ZM1857.32,472v-.71l-.5.5-42.06-42.05h0l-44.48-44.47-44.47,44.47h86.53L1769.09,473h86.52l-42.76,42.76,44.47,44.47V473.72l42.77,42.77L1944.56,472Zm-87-85.32,42.06,42.06h-84.11ZM1813.56,430,1855.62,472H1771.5Zm42.76,127.88-42-42.06,42-42.06ZM1858,473h84.12l-42.06,42.06Zm-44,215.61V601.1l-44.48,44.48,43.27,43.26-42.77,42.76h-85.82V644.37l-44,44h-85.82V602.81h.71l-.71-.71v-1l-.5.5-43.27-43.26-42.76,42.76V516l44-44h-87.52l-42.77-42.76h0l-44.47-44.48v87.53l-.71.71h.71v.71l.71-.71H1424l42.76,42.76-43.26,43.27,43.26,43.26-.5.5h0l-42.76,42.77,44.47,44.47V602.81h84.82L1510,645.58l44.47,44.47h0l42.77,42.76,43.26-43.26,43.76,43.76h0L1727,776.07l43.47-43.47H1858ZM1338.15,387.2l42,42.06-21,21-21,21Zm21.23,64.29L1380.91,430,1423,472h-84.11Zm66,21.53h84.12l-41.56,41.56h0l-.5.5Zm41.56,44v84.12l-42.06-42.06Zm0,170.65-42.06-42.06,42.06-42.06Zm43.76-127.89,42.06,42.06h-84.11Zm42.77,43.77v84.12l-42.06-42.06Zm43.77,127.88-42.06-42.06h84.11Zm86-84.62V730.9l-42-42.06Zm129.8-43.26v84.11l-42.06-42Zm-86,171.14L1685,732.6h84.11Zm44.47-43.06,42-42.05,42.06,42.05Z\" />\n          </clipPath>\n        </defs>\n        <g className=\"fill-group\">\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1510.91 342.52 1510.91 299.26 1554.17 342.52 1510.91 385.79 1510.91 342.52\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1597.44 342.52 1640.7 342.52 1597.44 385.79 1554.17 342.52 1597.44 342.52\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1597.44 429.05 1554.17 429.05 1597.44 385.79 1640.7 429.05 1597.44 429.05\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1683.97 342.52 1727.23 342.52 1683.97 385.79 1640.7 342.52 1683.97 342.52\"\n          />\n\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1770.5 429.05 1727.23 429.05 1770.5 385.79 1813.76 429.05 1770.5 429.05\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1813.76 472.31 1770.5 472.31 1813.76 429.05 1857.03 472.31 1813.76 472.31\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1857.03 515.58 1857.03 558.84 1813.76 515.58 1857.03 472.31 1857.03 515.58\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1900.29 472.31 1943.56 472.31 1900.3 515.58 1857.03 472.31 1900.29 472.31\"\n          />\n\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1813.76 645.37 1813.76 688.63 1770.5 645.37 1813.76 602.1 1813.76 645.37\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1813.76 731.9 1770.5 731.9 1813.76 688.63 1857.03 731.9 1813.76 731.9\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1727.23 731.9 1770.5 731.9 1727.23 775.16 1683.97 731.9 1727.23 731.9\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1683.97 688.63 1683.97 731.9 1640.7 688.63 1683.97 645.37 1683.97 688.63\"\n          />\n\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1597.44 688.63 1640.7 688.63 1597.44 731.9 1554.17 688.63 1597.44 688.63\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1554.17 645.37 1554.17 688.63 1510.91 645.37 1554.17 602.11 1554.17 645.37\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1510.91 602.1 1467.64 602.1 1510.91 558.84 1554.17 602.1 1510.91 602.1\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1467.65 645.37 1467.65 688.63 1424.38 645.37 1467.65 602.11 1467.65 645.37\"\n          />\n\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1467.65 558.84 1467.65 602.11 1424.38 558.84 1467.65 515.58 1467.65 558.84\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1467.65 472.31 1510.91 472.31 1467.65 515.58 1424.38 472.31 1467.65 472.31\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1381.12 472.31 1337.85 472.31 1381.12 429.05 1424.38 472.31 1381.12 472.31\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1337.85 429.05 1337.85 385.79 1381.12 429.05 1337.85 472.31 1337.85 429.05\"\n          />\n        </g>\n      </svg>)\n}\n\nexport default JSVisual\n","import React, { useEffect, useState } from 'react'\nimport classnames from 'classnames'\nimport io from 'socket.io-client'\n\nimport SpeakerInfo from '../components/SpeakerInfo'\nimport JSVisual from '../components/JSVisual'\n\nimport './index.scss'\n\nconst emptyStage = {\n  speaker: {\n    name: '',\n    topic: '',\n  },\n}\n\nconst SOCKET_URL = 'https://stage-control.herokuapp.com/'\n\nconst IndexPage = props => {\n  const [stage, setStage] = useState(Object.assign({}, emptyStage))\n\n  useEffect(() => {\n    console.log('useEffect init')\n\n    const socket = io(SOCKET_URL, {})\n\n    socket.on('update', data => {\n      console.log('stage update', data)\n      setStage(data)\n    })\n\n    return () => {\n      console.log('useEffect cleanup')\n      socket.close()\n    }\n  }, [props])\n\n  return (\n    <div\n      className={classnames(\n        'visual',\n        stage.presentation && 'presentation-active',\n        stage.color || 'black'\n      )}\n      id=\"Visual\"\n    >\n      { stage && stage.event === 'js' && (<JSVisual presentation={stage.presentation} />)}\n\n      <SpeakerInfo stage={stage} />\n\n      <div className={classnames('presentation')}></div>\n      <div className=\"silhouette\"></div>\n      <div className=\"stage-bottom\"></div>\n    </div>\n  )\n}\n\nexport default IndexPage\n"],"sourceRoot":""}