{"version":3,"sources":["webpack:///./src/components/SpeakerInfo/index.js","webpack:///./src/pages/index.js"],"names":["SpeakerInfo","_ref","stage","speaker","react_default","a","createElement","className","name","topic","emptyStage","IndexPage","props","currentCluster","clusters","drawTimer","showPolygon","_asyncToGenerator","regenerator_default","mark","_callee","polygon","timeout","wrap","_context","prev","next","abrupt","Promise","resolve","baseVal","setTimeout","stop","_x","_x2","apply","this","arguments","hidePolygon","_ref2","_callee2","_context2","replace","_x3","_x4","show","_ref3","_callee3","prevCluster","nextCluster","i","prevPolygon","nextPolygon","_context3","length","console","log","all","_useState","useState","Object","assign","setStage","useEffect","socket","io","on","data","Array","from","document","querySelectorAll","reduce","arr","triangle","indexMatch","match","push","close","clearTimeout","forEach","classnames","presentation","color","id","data-name","xmlns","xlink","width","height","viewBox","d","points","src_components_SpeakerInfo"],"mappings":"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","file":"component---src-pages-index-js-be7b342420cf3660e8c0.js","sourcesContent":["import React from 'react'\nimport './index.scss'\n\nconst SpeakerInfo = ({ stage }) =>\n  stage.speaker && (\n    <div className=\"speaker-info\">\n      <span className=\"name\">{stage.speaker.name}</span>\n      <span className=\"topic\">{stage.speaker.topic}</span>\n    </div>\n  )\n\nexport default SpeakerInfo\n","import React, { useEffect, useState } from 'react'\nimport classnames from 'classnames'\nimport io from 'socket.io-client'\n\nimport SpeakerInfo from '../components/SpeakerInfo'\n\nimport './index.scss'\n\nconst emptyStage = {\n  speaker: {\n    name: '',\n    topic: '',\n  },\n}\n\n//const SOCKET_URL = 'http://0.0.0.0:8000'\nconst SOCKET_URL = 'https://stage-control.herokuapp.com/'\n\nconst IndexPage = props => {\n  const clusterLength = 4\n  let currentCluster = 0\n  let clusters = []\n  let nextClusterTimeout = 3000\n  let drawTimer = 0\n\n  const readClusters = () => {\n    return Array.from(\n      document.querySelectorAll('polygon[class^=cluster-]')\n    ).reduce((arr, triangle) => {\n      const indexMatch = triangle.className.baseVal.match(/^cluster-(\\d)/)\n      if (indexMatch) {\n        if (!arr[indexMatch[1] - 1]) {\n          arr.push([])\n        }\n        arr[indexMatch[1] - 1].push(triangle)\n      }\n      return arr\n    }, [])\n  }\n\n  const showPolygon = async (polygon, timeout) => {\n    return new Promise(resolve => {\n      polygon.className.baseVal += ' show'\n      setTimeout(resolve, timeout)\n    })\n  }\n\n  const hidePolygon = async (polygon, timeout) => {\n    return new Promise(resolve => {\n      polygon.className.baseVal = polygon.className.baseVal.replace(' show', '')\n      setTimeout(resolve, timeout)\n    })\n  }\n\n  const show = async () => {\n    const prevCluster =\n      currentCluster !== 0\n        ? clusters[currentCluster - 1]\n        : clusters[clusters.length - 1]\n    const nextCluster = clusters[currentCluster]\n\n    const prevLength = prevCluster.length\n    const nextLength = nextCluster.length\n\n    console.log(currentCluster)\n\n    for (let i = 0; i < clusterLength; i++) {\n      const prevPolygon = prevCluster[i]\n      const nextPolygon = nextCluster[i]\n      await Promise.all([\n        hidePolygon(prevPolygon, 200),\n        showPolygon(nextPolygon, 200),\n      ])\n    }\n\n    currentCluster += 1\n\n    if (!clusters[currentCluster]) {\n      currentCluster = 0\n    }\n    drawTimer = setTimeout(show, nextClusterTimeout)\n  }\n\n  const [stage, setStage] = useState(Object.assign({}, emptyStage))\n\n  useEffect(() => {\n    console.log('useEffect init')\n\n    const socket = io(SOCKET_URL, {})\n\n    socket.on('update', data => {\n      console.log('stage update', data)\n      setStage(data)\n    })\n\n    clusters = readClusters()\n    show()\n\n    return () => {\n      console.log('useEffect cleanup')\n\n      socket.close()\n\n      clusters = []\n      currentCluster = 0\n      clearTimeout(drawTimer)\n\n      Array.from(document.querySelectorAll('polygon.fill')).forEach(polygon => {\n        polygon.className.baseVal = polygon.className.baseVal.replace(\n          'show',\n          ''\n        )\n      })\n    }\n  }, [props])\n\n  return (\n    <div\n      className={classnames(\n        'visual',\n        stage.presentation && 'presentation-active',\n        stage.color || 'black'\n      )}\n      id=\"Visual\"\n    >\n      <svg\n        data-name=\"Layer 3\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        xlink=\"http://www.w3.org/1999/xlink\"\n        width=\"3280\"\n        height=\"1080\"\n        viewBox=\"0 0 3280 1080\"\n      >\n        <defs>\n          <clipPath id=\"mask\" className=\"mask\">\n            <path d=\"M1596.53,386l-43.77,43.77h89L1597.94,386l42.56-42.56,43.27,43.26,44.47-44.47H1554.18l-44-44V387.2L1554,343.44Zm129.29-42.76-42,42.06-42.06-42.06Zm-170.64,85.53,42-42.06,42.06,42.06Zm84.11-85.53-42,42.06-42.06-42.06Zm-128.08,41.56V300.67l41.55,41.56h0l.5.5ZM1857.32,472v-.71l-.5.5-42.06-42.05h0l-44.48-44.47-44.47,44.47h86.53L1769.09,473h86.52l-42.76,42.76,44.47,44.47V473.72l42.77,42.77L1944.56,472Zm-87-85.32,42.06,42.06h-84.11ZM1813.56,430,1855.62,472H1771.5Zm42.76,127.88-42-42.06,42-42.06ZM1858,473h84.12l-42.06,42.06Zm-44,215.61V601.1l-44.48,44.48,43.27,43.26-42.77,42.76h-85.82V644.37l-44,44h-85.82V602.81h.71l-.71-.71v-1l-.5.5-43.27-43.26-42.76,42.76V516l44-44h-87.52l-42.77-42.76h0l-44.47-44.48v87.53l-.71.71h.71v.71l.71-.71H1424l42.76,42.76-43.26,43.27,43.26,43.26-.5.5h0l-42.76,42.77,44.47,44.47V602.81h84.82L1510,645.58l44.47,44.47h0l42.77,42.76,43.26-43.26,43.76,43.76h0L1727,776.07l43.47-43.47H1858ZM1338.15,387.2l42,42.06-21,21-21,21Zm21.23,64.29L1380.91,430,1423,472h-84.11Zm66,21.53h84.12l-41.56,41.56h0l-.5.5Zm41.56,44v84.12l-42.06-42.06Zm0,170.65-42.06-42.06,42.06-42.06Zm43.76-127.89,42.06,42.06h-84.11Zm42.77,43.77v84.12l-42.06-42.06Zm43.77,127.88-42.06-42.06h84.11Zm86-84.62V730.9l-42-42.06Zm129.8-43.26v84.11l-42.06-42Zm-86,171.14L1685,732.6h84.11Zm44.47-43.06,42-42.05,42.06,42.05Z\" />\n          </clipPath>\n        </defs>\n        <g className=\"fill-group\">\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1510.91 342.52 1510.91 299.26 1554.17 342.52 1510.91 385.79 1510.91 342.52\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1597.44 342.52 1640.7 342.52 1597.44 385.79 1554.17 342.52 1597.44 342.52\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1597.44 429.05 1554.17 429.05 1597.44 385.79 1640.7 429.05 1597.44 429.05\"\n          />\n          <polygon\n            className=\"cluster-1 fill\"\n            points=\"1683.97 342.52 1727.23 342.52 1683.97 385.79 1640.7 342.52 1683.97 342.52\"\n          />\n\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1770.5 429.05 1727.23 429.05 1770.5 385.79 1813.76 429.05 1770.5 429.05\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1813.76 472.31 1770.5 472.31 1813.76 429.05 1857.03 472.31 1813.76 472.31\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1857.03 515.58 1857.03 558.84 1813.76 515.58 1857.03 472.31 1857.03 515.58\"\n          />\n          <polygon\n            className=\"cluster-2 fill\"\n            points=\"1900.29 472.31 1943.56 472.31 1900.3 515.58 1857.03 472.31 1900.29 472.31\"\n          />\n\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1813.76 645.37 1813.76 688.63 1770.5 645.37 1813.76 602.1 1813.76 645.37\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1813.76 731.9 1770.5 731.9 1813.76 688.63 1857.03 731.9 1813.76 731.9\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1727.23 731.9 1770.5 731.9 1727.23 775.16 1683.97 731.9 1727.23 731.9\"\n          />\n          <polygon\n            className=\"cluster-3 fill\"\n            points=\"1683.97 688.63 1683.97 731.9 1640.7 688.63 1683.97 645.37 1683.97 688.63\"\n          />\n\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1597.44 688.63 1640.7 688.63 1597.44 731.9 1554.17 688.63 1597.44 688.63\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1554.17 645.37 1554.17 688.63 1510.91 645.37 1554.17 602.11 1554.17 645.37\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1510.91 602.1 1467.64 602.1 1510.91 558.84 1554.17 602.1 1510.91 602.1\"\n          />\n          <polygon\n            className=\"cluster-4 fill\"\n            points=\"1467.65 645.37 1467.65 688.63 1424.38 645.37 1467.65 602.11 1467.65 645.37\"\n          />\n\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1467.65 558.84 1467.65 602.11 1424.38 558.84 1467.65 515.58 1467.65 558.84\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1467.65 472.31 1510.91 472.31 1467.65 515.58 1424.38 472.31 1467.65 472.31\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1381.12 472.31 1337.85 472.31 1381.12 429.05 1424.38 472.31 1381.12 472.31\"\n          />\n          <polygon\n            className=\"cluster-5 fill\"\n            points=\"1337.85 429.05 1337.85 385.79 1381.12 429.05 1337.85 472.31 1337.85 429.05\"\n          />\n        </g>\n      </svg>\n\n      <SpeakerInfo stage={stage} />\n\n      <div className={classnames('presentation')}></div>\n      <div className=\"silhouette\"></div>\n      <div className=\"stage-bottom\"></div>\n    </div>\n  )\n}\n\nexport default IndexPage\n"],"sourceRoot":""}