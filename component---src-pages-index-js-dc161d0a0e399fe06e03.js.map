{"version":3,"sources":["webpack:///./src/components/SpeakerInfo/index.js","webpack:///./src/components/JSVisual/index.js","webpack:///./src/pages/index.js"],"names":["SpeakerInfo","_ref","stage","speaker","react_default","a","createElement","className","name","topic","JSVisual","presentation","drawTimer","useRef","clusters","currentCluster","showPolygon","_ref2","_asyncToGenerator","regenerator_default","mark","_callee","polygon","timeout","wrap","_context","prev","next","abrupt","Promise","resolve","baseVal","setTimeout","stop","_x","_x2","apply","this","arguments","hidePolygon","_ref3","_callee2","_context2","replace","_x3","_x4","show","_ref4","_callee3","prevCluster","nextCluster","prevLength","nextLength","clusterLength","i","prevPolygon","nextPolygon","_context3","current","length","Math","max","all","useEffect","console","log","Array","from","document","querySelectorAll","reduce","arr","triangle","indexMatch","parentElement","match","push","clearTimeout","forEach","width","height","viewBox","d","emptyStage","IndexPage","props","_useState","useState","Object","assign","setStage","socket","io","on","data","close","classnames","color","id","event","src_components_JSVisual","src_components_SpeakerInfo"],"mappings":"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","file":"component---src-pages-index-js-dc161d0a0e399fe06e03.js","sourcesContent":["import React from 'react'\nimport './index.scss'\n\nconst SpeakerInfo = ({ stage }) =>\n  stage.speaker && (\n    <div className=\"speaker-info\">\n      <span className=\"name\">{stage.speaker.name}</span>\n      <span className=\"topic\">{stage.speaker.topic}</span>\n    </div>\n  )\n\nexport default SpeakerInfo\n","import React, { useEffect, useRef } from 'react'\nimport classnames from 'classnames'\nimport './index.scss'\n\nconst JSVisual = ({ presentation }) => {\n  const drawTimer = useRef(0)\n  const clusters = useRef([])\n  let currentCluster = 0\n  let nextClusterTimeout = 3000\n\n  const readClusters = () => {\n    return Array.from(\n      document.querySelectorAll('g[class^=cluster-] path')\n    ).reduce((arr, triangle) => {\n      const indexMatch = triangle.parentElement.className.baseVal.match(\n        /^cluster-(\\d)/\n      )\n\n      if (indexMatch) {\n        if (!arr[indexMatch[1] - 1]) {\n          arr.push([])\n        }\n        arr[indexMatch[1] - 1].push(triangle)\n      }\n      return arr\n    }, [])\n  }\n\n  const showPolygon = async (polygon, timeout) => {\n    if (!polygon) return Promise.resolve()\n\n    return new Promise(resolve => {\n      polygon.className.baseVal += ' show'\n      setTimeout(resolve, timeout)\n    })\n  }\n\n  const hidePolygon = async (polygon, timeout) => {\n    if (!polygon) return Promise.resolve()\n\n    return new Promise(resolve => {\n      polygon.className.baseVal = polygon.className.baseVal.replace(' show', '')\n      setTimeout(resolve, timeout)\n    })\n  }\n\n  const show = async () => {\n    const prevCluster =\n      currentCluster !== 0\n        ? clusters.current[currentCluster - 1]\n        : clusters.current[clusters.current.length - 1]\n\n        \n    const nextCluster = clusters.current[currentCluster]\n    const prevLength = prevCluster.length\n    const nextLength = nextCluster.length\n\n    const clusterLength = Math.max(prevLength, nextLength)\n\n    for (let i = 0; i < clusterLength; i++) {\n      const prevPolygon = prevCluster[i]\n      const nextPolygon = nextCluster[i]\n\n      await Promise.all([\n        hidePolygon(prevPolygon, 200),\n        showPolygon(nextPolygon, 200),\n      ])\n    }\n\n    currentCluster += 1\n\n    if (!clusters.current[currentCluster]) {\n      currentCluster = 0\n    }\n    drawTimer.current = setTimeout(show, nextClusterTimeout)\n  }\n\n  useEffect(() => {\n    console.log('useEffect init')\n    clusters.current = readClusters()\n    console.log({ clusters })\n\n    show()\n\n    return () => {\n      console.log('useEffect cleanup')\n\n      clusters.current = []\n      currentCluster = 0\n      clearTimeout(drawTimer.current)\n\n      Array.from(document.querySelectorAll('path.fill')).forEach(triangle => {\n        triangle.className.baseVal = triangle.className.baseVal.replace(\n          'show',\n          ''\n        )\n      })\n    }\n  }, [presentation])\n\n  return (\n    <svg width=\"3280\" height=\"1080\" viewBox=\"0 0 3280 1080\">\n      <g className=\"cluster-1\">\n        <path d=\"M1240.99,617.07v88.94l-44.47-44.47L1240.99,617.07z M1239.99,703.6v-84.12l-42.06,42.06L1239.99,703.6z\" />\n        <path d=\"M1196.52,749.09v-88.94l44.47,44.47L1196.52,749.09z M1197.52,662.56v84.12l42.06-42.06L1197.52,662.56z\" />\n        <path d=\"M1284.76,748.38h-88.94l44.47-44.47L1284.76,748.38z M1198.23,747.38h84.12l-42.06-42.06L1198.23,747.38z\" />\n        <path d=\"M1134.63,809.57l62.89-62.89l0,62.89L1134.63,809.57z M1196.52,749.09l-59.48,59.48l59.48,0L1196.52,749.09z\" />\n        <path d=\"M1134.63,809.57h-88.94l44.47-44.47L1134.63,809.57z M1048.09,808.57h84.12l-42.06-42.06L1048.09,808.57z\" />\n        <path d=\"M1286.46,872.46h-88.94l44.47-44.47L1286.46,872.46z M1199.93,871.46h84.12l-42.06-42.06L1199.93,871.46z\" />\n        <path d=\"M1071.73,872.46l62.89-62.89l0,62.89L1071.73,872.46z M1133.63,811.98l-59.48,59.48l59.48,0L1133.63,811.98z\" />\n        <path d=\"M1071.73,872.46v88.94l-44.47-44.47L1071.73,872.46z M1070.73,958.99v-84.12l-42.06,42.06L1070.73,958.99z\" />\n        <path d=\"M938.32,916.93h88.94l-44.47,44.47L938.32,916.93z M1024.85,917.93h-84.12l42.06,42.06L1024.85,917.93z\" />\n      </g>\n      <g className=\"cluster-2\">\n        <path d=\"M920.43,89.44h-88.94l44.47-44.47L920.43,89.44z M833.9,88.44h84.12l-42.06-42.06L833.9,88.44z\" />\n        <path d=\"M920.43,178.39V89.44l44.47,44.47L920.43,178.39z M921.43,91.86v84.12l42.06-42.06L921.43,91.86z\" />\n        <path d=\"M920.43,178.6h88.94l-44.47,44.47L920.43,178.6z M1006.96,179.6h-84.12l42.06,42.06L1006.96,179.6z\" />\n        <path d=\"M1053.85,133.92v88.94l-44.47-44.47L1053.85,133.92z M1052.85,220.45v-84.12l-42.06,42.06L1052.85,220.45z\" />\n        <path d=\"M1053.85,222.92h88.94l-44.47,44.47L1053.85,222.92z M1140.38,223.92h-84.12l42.06,42.06L1140.38,223.92z\" />\n        <path d=\"M1231.74,222.86h-88.94l44.47-44.47L1231.74,222.86z M1145.21,221.86h84.12l-42.06-42.06L1145.21,221.86z\" />\n        <path d=\"M1231.74,133.91h-88.94l44.47-44.47L1231.74,133.91z M1145.21,132.91h84.12l-42.06-42.06L1145.21,132.91z\" />\n        <path d=\"M1231.74,311.8v-88.94l44.47,44.47L1231.74,311.8z M1232.74,225.27v84.12l42.06-42.06L1232.74,225.27z\" />\n        <path d=\"M1276.21,311.8v-88.94l44.47,44.47L1276.21,311.8z M1277.21,225.27v84.12l42.06-42.06L1277.21,225.27z\" />\n        <path d=\"M1276.21,311.8v88.94l-44.47-44.47L1276.21,311.8z M1275.21,398.33v-84.12l-42.06,42.06L1275.21,398.33z\" />\n      </g>\n      <g className=\"cluster-3\">\n        <path d=\"M118.93,212.72v-88.94l44.47,44.47L118.93,212.72z M119.93,126.19v84.12l42.06-42.06L119.93,126.19z\" />\n        <path d=\"M118.93,212.72h88.94l-44.47,44.47L118.93,212.72z M205.46,213.72h-84.12l42.06,42.06L205.46,213.72z\" />\n        <path d=\"M207.16,211.99v88.94l-44.47-44.47L207.16,211.99z M206.16,298.52v-84.12l-42.06,42.06L206.16,298.52z\" />\n        <path d=\"M29.99,212.72h88.94l-44.47,44.47L29.99,212.72z M116.52,213.72H32.4l42.06,42.06L116.52,213.72z\" />\n        <path d=\"M74.46,257.19h88.94l-44.47,44.47L74.46,257.19z M160.99,258.19H76.87l42.06,42.06L160.99,258.19z\" />\n        <path d=\"M118.93,390.6v-88.94l44.47,44.47L118.93,390.6z M119.93,304.07v84.12l42.06-42.06L119.93,304.07z\" />\n      </g>\n      <g className=\"cluster-4\">\n        <path d=\"M617.43,29.94l62.89,0l-62.89,62.89L617.43,29.94z M618.43,30.94l0,59.48l59.48-59.48L618.43,30.94z\" />\n        <path d=\"M554.54,92.83l62.89,0l-62.89,62.89L554.54,92.83z M555.54,93.83l0,59.48l59.48-59.48L555.54,93.83z\" />\n        <path d=\"M491.64,155.7l0-62.89l62.89,62.89L491.64,155.7z M492.64,154.7l59.48,0l-59.48-59.48L492.64,154.7z\" />\n        <path d=\"M430.71,154.72l62.89,0l-62.89,62.89L430.71,154.72z M431.71,155.72l0,59.48l59.48-59.48L431.71,155.72z\" />\n        <path d=\"M430.71,91.83l0,62.89l-62.89-62.89L430.71,91.83z M429.71,92.83l-59.48,0l59.48,59.48L429.71,92.83z\" />\n        <path d=\"M323.08,136.3V47.36l44.47,44.47L323.08,136.3z M324.08,49.77v84.12l42.06-42.06L324.08,49.77z\" />\n      </g>\n      <g className=\"cluster-5\">\n        <path d=\"M310.88,915.84V826.9l44.47,44.47L310.88,915.84z M311.88,829.31v84.12l42.06-42.06L311.88,829.31z\" />\n        <path d=\"M312.25,827.9H223.3l44.47-44.47L312.25,827.9z M225.72,826.9h84.12l-42.06-42.06L225.72,826.9z\" />\n        <path d=\"M223.25,738.96v88.94l-44.47-44.47L223.25,738.96z M222.25,825.49v-84.12l-42.06,42.06L222.25,825.49z\" />\n        <path d=\"M134.31,827.9v-88.94l44.47,44.47L134.31,827.9z M135.31,741.37v84.12l42.06-42.06L135.31,741.37z\" />\n        <path d=\"M223.3,738.96v-88.94l44.47,44.47L223.3,738.96z M224.3,652.43v84.12l42.06-42.06L224.3,652.43z\" />\n        <path d=\"M178.78,605.54h88.94l-44.47,44.47L178.78,605.54z M265.31,606.54h-84.12l42.06,42.06L265.31,606.54z\" />\n        <path d=\"M93.27,605.54h88.94l-44.47,44.47L93.27,605.54z M179.8,606.54H95.68l42.06,42.06L179.8,606.54z\" />\n        <path d=\"M181.25,519.01v88.94l-44.47-44.47L181.25,519.01z M180.25,605.54v-84.12l-42.06,42.06L180.25,605.54z\" />\n      </g>\n    </svg>\n  )\n}\n\nexport default JSVisual\n","import React, { useEffect, useState } from 'react'\nimport classnames from 'classnames'\nimport io from 'socket.io-client'\n\nimport SpeakerInfo from '../components/SpeakerInfo'\nimport JSVisual from '../components/JSVisual'\n\nimport './index.scss'\n\nconst emptyStage = {\n  speaker: {\n    name: '',\n    topic: '',\n  },\n}\n\nconst SOCKET_URL = 'https://stage-control.herokuapp.com/'\n\nconst IndexPage = props => {\n  const [stage, setStage] = useState(Object.assign({}, emptyStage))\n\n  useEffect(() => {\n    console.log('useEffect init')\n\n    const socket = io(SOCKET_URL, {})\n\n    socket.on('update', data => {\n      console.log('stage update', data)\n      setStage(data)\n    })\n\n    return () => {\n      console.log('useEffect cleanup')\n      socket.close()\n    }\n  }, [props])\n\n  return (\n    <div\n      className={classnames(\n        'visual',\n        stage.presentation && 'presentation-active',\n        stage.color || 'black'\n      )}\n      id=\"Visual\"\n    >\n      {stage && stage.event === 'js' && (\n        <JSVisual presentation={stage.presentation} />\n      )}\n\n      <SpeakerInfo stage={stage} />\n\n      <div className={classnames('presentation')}></div>\n      <div className=\"silhouette\"></div>\n      <div className=\"stage-bottom\"></div>\n    </div>\n  )\n}\n\nexport default IndexPage\n"],"sourceRoot":""}